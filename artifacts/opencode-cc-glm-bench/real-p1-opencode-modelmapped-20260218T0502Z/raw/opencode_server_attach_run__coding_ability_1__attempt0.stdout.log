{"type":"step_start","timestamp":1771390900432,"sessionID":"ses_390e0047affeVx3VYKbr8LD6IR","part":{"id":"prt_c6f20188d001E91zSsCPHpKY4U","sessionID":"ses_390e0047affeVx3VYKbr8LD6IR","messageID":"msg_c6f1ffcb200100jtCUg2ZjzGN1","type":"step-start","snapshot":"f6728a342f0f794ed17e2f07007cd8a71ed7f0fa"}}
{"type":"text","timestamp":1771390925517,"sessionID":"ses_390e0047affeVx3VYKbr8LD6IR","part":{"id":"prt_c6f2020d5001qyRF1D5XFG6NtD","sessionID":"ses_390e0047affeVx3VYKbr8LD6IR","messageID":"msg_c6f1ffcb200100jtCUg2ZjzGN1","type":"text","text":"```python\nimport re\nfrom typing import List, Tuple\n\ndef _parse_prerelease(prerelease: str) -> Tuple[int, List[str | int]]:\n    if not prerelease:\n        return (1, [])\n    parts = prerelease.split('.')\n    parsed = []\n    for p in parts:\n        if p.isdigit():\n            parsed.append(int(p))\n        else:\n            parsed.append(p)\n    return (0, parsed)\n\ndef _compare_prerelease_parts(a: List[str | int], b: List[str | int]) -> int:\n    for i in range(max(len(a), len(b))):\n        if i >= len(a):\n            return -1\n        if i >= len(b):\n            return 1\n        av, bv = a[i], b[i]\n        if type(av) is int and type(bv) is int:\n            if av < bv:\n                return -1\n            if av > bv:\n                return 1\n        elif type(av) is int:\n            return -1\n        elif type(bv) is int:\n            return 1\n        else:\n            if av < bv:\n                return -1\n            if av > bv:\n                return 1\n    return 0\n\ndef compare_semver(a: str, b: str) -> int:\n    pattern = r'^(\\d+)\\.(\\d+)\\.(\\d+)(?:-([a-zA-Z0-9.-]+))?$'\n    ma = re.match(pattern, a)\n    mb = re.match(pattern, b)\n    if not ma or not mb:\n        raise ValueError(f\"Invalid semver: {a if not ma else b}\")\n    \n    major_a, minor_a, patch_a = int(ma.group(1)), int(ma.group(2)), int(ma.group(3))\n    major_b, minor_b, patch_b = int(mb.group(1)), int(mb.group(2)), int(mb.group(3))\n    \n    if (major_a, minor_a, patch_a) < (major_b, minor_b, patch_b):\n        return -1\n    if (major_a, minor_a, patch_a) > (major_b, minor_b, patch_b):\n        return 1\n    \n    pre_a = _parse_prerelease(ma.group(4) or '')\n    pre_b = _parse_prerelease(mb.group(4) or '')\n    \n    if pre_a[0] != pre_b[0]:\n        return -1 if pre_a[0] < pre_b[0] else 1\n    \n    return _compare_prerelease_parts(pre_a[1], pre_b[1])\n\n\nimport pytest\n\ndef test_equal_versions():\n    assert compare_semver(\"1.0.0\", \"1.0.0\") == 0\n\ndef test_major_difference():\n    assert compare_semver(\"2.0.0\", \"1.9.9\") == 1\n    assert compare_semver(\"1.0.0\", \"2.0.0\") == -1\n\ndef test_minor_difference():\n    assert compare_semver(\"1.2.0\", \"1.1.9\") == 1\n    assert compare_semver(\"1.1.0\", \"1.2.0\") == -1\n\ndef test_patch_difference():\n    assert compare_semver(\"1.0.2\", \"1.0.1\") == 1\n    assert compare_semver(\"1.0.1\", \"1.0.2\") == -1\n\ndef test_prerelease_lower_than_release():\n    assert compare_semver(\"1.0.0-alpha\", \"1.0.0\") == -1\n    assert compare_semver(\"1.0.0\", \"1.0.0-alpha\") == 1\n\ndef test_prerelease_lexicographic():\n    assert compare_semver(\"1.0.0-alpha\", \"1.0.0-beta\") == -1\n    assert compare_semver(\"1.0.0-beta\", \"1.0.0-alpha\") == 1\n\ndef test_prerelease_numeric_parts():\n    assert compare_semver(\"1.0.0-alpha.1\", \"1.0.0-alpha.2\") == -1\n    assert compare_semver(\"1.0.0-alpha.2\", \"1.0.0-alpha.1\") == 1\n    assert compare_semver(\"1.0.0-alpha.1\", \"1.0.0-alpha\") == 1\n\ndef test_prerelease_numeric_vs_string():\n    assert compare_semver(\"1.0.0-1\", \"1.0.0-alpha\") == -1\n    assert compare_semver(\"1.0.0-alpha\", \"1.0.0-1\") == 1\n```","time":{"start":1771390925514,"end":1771390925514}}}
{"type":"step_finish","timestamp":1771390925605,"sessionID":"ses_390e0047affeVx3VYKbr8LD6IR","part":{"id":"prt_c6f207acc001m266IfYj2fDruj","sessionID":"ses_390e0047affeVx3VYKbr8LD6IR","messageID":"msg_c6f1ffcb200100jtCUg2ZjzGN1","type":"step-finish","reason":"stop","snapshot":"1e4804d6c88f0d849bf5eff79e550dee10e12add","cost":0,"tokens":{"total":25889,"input":16182,"output":1067,"reasoning":0,"cache":{"read":8640,"write":0}}}}
