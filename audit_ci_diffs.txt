commit 275d137420e7b96aeda2764464214305c693b4fa
Author: fengning-starsend <fengning@stars-end.ai>
Date:   Sun Dec 21 08:47:53 2025 -0800

    chore: Remove all Supabase references from CI after Railway migration (#441)
    
    - Delete generate-schema-artifacts.yml (dead TypeScript type generation)
    - Delete auto-regenerate-schema.yml (dead auto-PR workflow)
    - Remove schema-drift-check job from ci.yml (tied to supabase/ paths)
    - Remove SUPABASE_* env vars from all tier jobs
    - Remove mise install supabase from tier1_ui, tier2_auth, tier3_full
    - Change tier3 from --use-hosted-supabase to --use-local-supabase
    - Update run-local-ci.sh to skip Supabase env checks when USE_RAILWAY_DB=true
    - Remove supabase path filter from changes detection
    
    The TypeScript types generated by supabase gen types were never used -
    supabase/types/ directory doesn't exist and has zero frontend imports.
    Pydantic schemas (backend/schemas/generated/) use sb-pydantic with
    Railway DATABASE_URL directly and continue to work.
    
    Feature-Key: bd-kx4u
    Agent: antigravity
    Role: devops-engineer

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index ebb836c..2c52951 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -19,7 +19,6 @@ jobs:
     name: Detect Changes
     runs-on: [self-hosted, linux, x64]
     outputs:
-      supabase: ${{ steps.filter.outputs.supabase }}
       backend: ${{ steps.filter.outputs.backend }}
       frontend: ${{ steps.filter.outputs.frontend }}
       workflows_ci: ${{ steps.filter.outputs.workflows_ci }}
@@ -33,8 +32,6 @@ jobs:
         uses: dorny/paths-filter@v3
         with:
           filters: |
-            supabase:
-              - 'supabase/**'
             backend_code:
               - 'backend/**'
               - '!backend/tests/**'
@@ -163,10 +160,6 @@ jobs:
       CLERK_TEST_PRIVATE_KEY_PATH: ${{ github.workspace }}/frontend/e2e-smoke/fixtures/clerk-test-private.pem
       CLERK_JWKS_URL: http://127.0.0.1:8000/.well-known/jwks.json
       CLERK_JWT_ISSUER: http://127.0.0.1:8000
-      # Legacy Supabase fallback vars (for config bootstrap)
-      SUPABASE_URL: http://localhost
-      SUPABASE_SERVICE_ROLE_KEY: dummy
-      SUPABASE_ANON_KEY: dummy
     steps:
       - uses: actions/checkout@v4
 
@@ -225,10 +218,6 @@ jobs:
     env:
       CI: "1"
       USE_RAILWAY_DB: "true"
-      # Legacy Supabase fallback vars (for config bootstrap)
-      SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
-      SUPABASE_SERVICE_ROLE_KEY: ${{ secrets.SUPABASE_SERVICE_ROLE_KEY }}
-      SUPABASE_ANON_KEY: ${{ secrets.SUPABASE_ANON_KEY }}
       DATABASE_URL: ${{ secrets.DATABASE_URL }}
     steps:
       - uses: actions/checkout@v4
@@ -264,111 +253,6 @@ jobs:
           path: backend/test-results/
           retention-days: 7
 
-  schema-drift-check:
-    name: Schema Drift Check
-    runs-on: [self-hosted, linux, x64]
-    needs: changes
-    if: github.event_name == 'pull_request' && needs.changes.outputs.supabase == 'true'
-    steps:
-      - uses: actions/checkout@v4
-        with:
-          fetch-depth: 0
-
-      - name: Install mise toolchain
-        run: |
-          curl -sSfL https://mise.run | sh
-          echo "$HOME/.local/bin" >> "$GITHUB_PATH"
-          echo "$HOME/.local/share/mise/shims" >> "$GITHUB_PATH"
-          ~/.local/bin/mise trust --yes || true
-          # Schema drift check only needs go; Python provided by runner, PostgreSQL via apt-get
-          ~/.local/bin/mise install go
-          ~/.local/bin/mise doctor --quiet || echo "mise doctor completed with warnings"
-
-      - name: Install PostgreSQL client
-        run: |
-          sudo apt-get update
-          sudo apt-get install -y ca-certificates curl gnupg
-          curl https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo gpg --dearmor -o /etc/apt/trusted.gpg.d/postgresql.gpg
-          echo "deb http://apt.postgresql.org/pub/repos/apt/ $(lsb_release -cs)-pgdg main" | sudo tee /etc/apt/sources.list.d/pgdg.list
-          sudo apt-get update
-          sudo apt-get install -y postgresql-client-17
-          pg_dump --version
-
-      - name: Setup Supabase CLI
-        uses: supabase/setup-cli@v1
-        with:
-          version: latest
-
-      - name: Setup Poetry
-        uses: ./.github/actions/setup-poetry
-
-      - name: Install backend dependencies
-        run: |
-          cd backend
-          poetry install --no-interaction --no-root
-
-
-
-      - name: Run schema preflight checks
-        run: |
-          # Use real Railway environment variables for schema validation
-          export SUPABASE_PROJECT_ID="${{ secrets.SUPABASE_PROJECT_ID }}"
-          export SUPABASE_URL="${{ secrets.SUPABASE_URL }}" 
-          export SUPABASE_SERVICE_ROLE_KEY="${{ secrets.SUPABASE_SERVICE_ROLE_KEY }}"
-          export DATABASE_URL="${{ secrets.DATABASE_URL }}"
-          export CI_MODE="1"
-          # Run preflight in CI mode (non-interactive)
-          if [ -f "scripts/schema_preflight.sh" ]; then
-            ./scripts/schema_preflight.sh || exit 1
-          else
-            echo "âŒ Schema preflight script missing"
-            exit 1
-          fi
-
-      - name: Generate current schema snapshot
-        env:
-          DATABASE_URL: ${{ secrets.DATABASE_URL }}
-        run: |
-          # Generate current schema snapshot using helper script
-          cd backend && poetry run python tools/generate_schema_snapshot.py
-
-      - name: Check for schema drift
-        run: |
-          # Generate diff between current and golden schema
-          if [ -f "supabase/migrations/current_schema.sql" ] && [ -f "supabase/migrations/golden_schema.sql" ]; then
-            # Use diff to compare schemas
-            diff -u supabase/migrations/golden_schema.sql supabase/migrations/current_schema.sql > diff.sql || true
-            
-            # Check if there are actual schema changes
-            if [ -s diff.sql ]; then
-              echo "ðŸš¨ Schema drift detected!"
-              echo "Changes found between golden snapshot and current state:"
-              cat diff.sql
-              
-              # Check if any migration files were actually changed in this PR
-              if git diff --name-only origin/master...HEAD | grep -E "supabase/migrations/.*\.sql$"; then
-                echo "âœ… Migration files detected in PR - drift may be intentional"
-                exit 0
-              else
-                echo "âŒ No migration files found in PR - schema drift requires migration or golden snapshot update"
-                exit 1
-              fi
-            else
-              echo "âœ… No schema drift detected"
-            fi
-          else
-            echo "âŒ Schema files missing for comparison"
-            exit 1
-          fi
-
-      - name: Upload drift report
-        if: failure()
-        uses: actions/upload-artifact@v4
-        with:
-          name: schema-drift-report
-          path: diff.sql
-          retention-days: 7
-
   ci-lite:
     name: CI Lite (Lint + Unit)
     runs-on: [self-hosted, linux, x64]
@@ -474,8 +358,6 @@ jobs:
       CI: "1"
       USE_RAILWAY_DB: "true"
       DATABASE_URL: ${{ secrets.DATABASE_URL }}
-      SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
-      SUPABASE_SERVICE_ROLE_KEY: ${{ secrets.SUPABASE_SERVICE_ROLE_KEY }}
       # Test user configuration for E2E tests
       TEST_USER_EMAIL: ${{ secrets.TEST_USER_EMAIL }}
       TEST_USER_PASSWORD: ${{ secrets.TEST_USER_PASSWORD }}
@@ -542,8 +424,8 @@ jobs:
           echo "$HOME/.local/bin" >> "$GITHUB_PATH"
           echo "$HOME/.local/share/mise/shims" >> "$GITHUB_PATH"
           ~/.local/bin/mise trust --yes || true
-          # Tier 1 needs node/pnpm/go/supabase; Python is provided by runner/setup-python in later steps
-          ~/.local/bin/mise install node pnpm go supabase
+          # Tier 1 needs node/pnpm/go; Python is provided by runner/setup-python in later steps
+          ~/.local/bin/mise install node pnpm go
           ~/.local/bin/mise doctor --quiet || echo "mise doctor completed with warnings"
 
       - name: Setup Poetry
@@ -608,7 +490,6 @@ jobs:
       CLERK_TEST_JWKS_PATH: ${{ github.workspace }}/frontend/e2e-smoke/fixtures/clerk-test-jwks.json
       CLERK_TEST_PRIVATE_KEY_PATH: ${{ github.workspace }}/frontend/e2e-smoke/fixtures/clerk-test-private.pem
       # NOTE: VITE_USE_LOCAL_PROXY removed - Vite proxy handles API calls (avoids CORS localhost/127.0.0.1 mismatch)
-      # Railway DB is primary; Supabase kept for compatibility
       DATABASE_URL: ${{ secrets.DATABASE_URL }}
       TEST_USER_ROLE: authenticated
       TEST_USER_EMAIL: ${{ secrets.TEST_USER_EMAIL }}
@@ -629,7 +510,7 @@ jobs:
           echo "$HOME/.local/share/mise/shims" >> "$GITHUB_PATH"
           ~/.local/bin/mise trust --yes || true
           # Tier 2 needs node/pnpm/go; Python is provided by runner/setup-python in later steps
-          ~/.local/bin/mise install node pnpm go supabase
+          ~/.local/bin/mise install node pnpm go
           ~/.local/bin/mise doctor --quiet || echo "mise doctor completed with warnings"
 
       - name: Setup Poetry
@@ -724,7 +605,6 @@ jobs:
       CLERK_TEST_JWKS_PATH: ${{ github.workspace }}/frontend/e2e-smoke/fixtures/clerk-test-jwks.json
       CLERK_TEST_PRIVATE_KEY_PATH: ${{ github.workspace }}/frontend/e2e-smoke/fixtures/clerk-test-private.pem
       # NOTE: VITE_USE_LOCAL_PROXY removed - Vite proxy handles API calls (avoids CORS localhost/127.0.0.1 mismatch)
-      # Railway DB is primary; Supabase kept for compatibility
       DATABASE_URL: ${{ secrets.DATABASE_URL }}
       TEST_USER_ROLE: authenticated
       TEST_USER_EMAIL: ${{ secrets.TEST_USER_EMAIL }}
@@ -744,8 +624,8 @@ jobs:
           echo "$HOME/.local/bin" >> "$GITHUB_PATH"
           echo "$HOME/.local/share/mise/shims" >> "$GITHUB_PATH"
           ~/.local/bin/mise trust --yes || true
-          # Tier 3 needs node/pnpm/go/supabase; Python is provided by runner/setup-python in later steps
-          ~/.local/bin/mise install node pnpm go supabase
+          # Tier 3 needs node/pnpm/go; Python is provided by runner/setup-python in later steps
+          ~/.local/bin/mise install node pnpm go
           ~/.local/bin/mise doctor --quiet || echo "mise doctor completed with warnings"
 
       - name: Setup Poetry
@@ -782,11 +662,11 @@ jobs:
       - name: Install Playwright browsers
         run: cd frontend && pnpm exec playwright install chromium
 
-      - name: Doctor hosted Supabase prerequisites
-        run: pnpm ci:doctor --mode hosted --tier full
+      - name: Doctor local prerequisites
+        run: pnpm ci:doctor --mode local --tier full
 
       - name: Run local CI harness (full tier)
-        run: ./scripts/run-local-ci.sh --playwright-tier=full --use-hosted-supabase --doctor
+        run: ./scripts/run-local-ci.sh --playwright-tier=full --use-local-supabase --doctor
 
       - name: Upload full tier artifacts
         if: failure()

commit b339af56030dcc45966031340a78463b1a0649ba
Author: fengning-starsend <fengning@stars-end.ai>
Date:   Sat Dec 20 15:38:10 2025 -0800

    chore: Remove orphaned llm-common submodule and CI config
    
    Submodule is no longer needed since pyproject.toml now uses git dependency.
    The submodules: recursive CI config was added in PRs #436, #437 but is now
    unnecessary overhead since there are no submodules to initialize.
    
    Feature-Key: bd-wd0a
    Agent: antigravity
    Role: devops-engineer

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index 0740229..ebb836c 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -169,8 +169,6 @@ jobs:
       SUPABASE_ANON_KEY: dummy
     steps:
       - uses: actions/checkout@v4
-        with:
-          submodules: recursive
 
       - name: Setup Python via mise
         uses: ./.github/actions/setup-python-mise
@@ -234,8 +232,6 @@ jobs:
       DATABASE_URL: ${{ secrets.DATABASE_URL }}
     steps:
       - uses: actions/checkout@v4
-        with:
-          submodules: recursive
 
       - name: Setup Python via mise
         uses: ./.github/actions/setup-python-mise
@@ -382,8 +378,6 @@ jobs:
       CI: "1"
     steps:
       - uses: actions/checkout@v4
-        with:
-          submodules: recursive
 
       - name: Setup Python via mise
         uses: ./.github/actions/setup-python-mise
@@ -487,8 +481,6 @@ jobs:
       TEST_USER_PASSWORD: ${{ secrets.TEST_USER_PASSWORD }}
     steps:
       - uses: actions/checkout@v4
-        with:
-          submodules: recursive
 
       - name: Setup Python via mise
         uses: ./.github/actions/setup-python-mise
@@ -623,8 +615,6 @@ jobs:
       TEST_USER_PASSWORD: ${{ secrets.TEST_USER_PASSWORD }}
     steps:
       - uses: actions/checkout@v4
-        with:
-          submodules: recursive
 
       - name: Validate Clerk stub fixtures
         run: scripts/ci/check_clerk_fixtures.sh
@@ -741,8 +731,6 @@ jobs:
       TEST_USER_PASSWORD: ${{ secrets.TEST_USER_PASSWORD }}
     steps:
       - uses: actions/checkout@v4
-        with:
-          submodules: recursive
 
       - name: Validate Clerk stub fixtures
         run: scripts/ci/check_clerk_fixtures.sh

commit 0db58eaa3c7f800ea25943081af06fa368935c4b
Author: fengning-starsend <fengning@stars-end.ai>
Date:   Sat Dec 20 13:50:00 2025 -0800

    fix(ci): Add submodules: recursive to ALL backend checkout steps
    
    Feature-Key: bd-vh8b
    Agent: antigravity
    Role: devops-engineer

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index 3b972e4..0740229 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -382,6 +382,8 @@ jobs:
       CI: "1"
     steps:
       - uses: actions/checkout@v4
+        with:
+          submodules: recursive
 
       - name: Setup Python via mise
         uses: ./.github/actions/setup-python-mise
@@ -485,6 +487,8 @@ jobs:
       TEST_USER_PASSWORD: ${{ secrets.TEST_USER_PASSWORD }}
     steps:
       - uses: actions/checkout@v4
+        with:
+          submodules: recursive
 
       - name: Setup Python via mise
         uses: ./.github/actions/setup-python-mise
@@ -619,6 +623,8 @@ jobs:
       TEST_USER_PASSWORD: ${{ secrets.TEST_USER_PASSWORD }}
     steps:
       - uses: actions/checkout@v4
+        with:
+          submodules: recursive
 
       - name: Validate Clerk stub fixtures
         run: scripts/ci/check_clerk_fixtures.sh
@@ -735,6 +741,8 @@ jobs:
       TEST_USER_PASSWORD: ${{ secrets.TEST_USER_PASSWORD }}
     steps:
       - uses: actions/checkout@v4
+        with:
+          submodules: recursive
 
       - name: Validate Clerk stub fixtures
         run: scripts/ci/check_clerk_fixtures.sh

commit 6f7fa65183b3dce1cf7f1f058fe4a0eab10c45d1
Author: fengning-starsend <fengning@stars-end.ai>
Date:   Sat Dec 20 13:42:23 2025 -0800

    fix(ci): Add submodules: recursive to backend checkout steps
    
    Feature-Key: bd-vh8b
    Agent: antigravity
    Role: devops-engineer

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index ebb836c..3b972e4 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -169,6 +169,8 @@ jobs:
       SUPABASE_ANON_KEY: dummy
     steps:
       - uses: actions/checkout@v4
+        with:
+          submodules: recursive
 
       - name: Setup Python via mise
         uses: ./.github/actions/setup-python-mise
@@ -232,6 +234,8 @@ jobs:
       DATABASE_URL: ${{ secrets.DATABASE_URL }}
     steps:
       - uses: actions/checkout@v4
+        with:
+          submodules: recursive
 
       - name: Setup Python via mise
         uses: ./.github/actions/setup-python-mise

commit 32c3507ab2dc220297709304555b5e5f6a9223be
Author: fengning-starsend <fengning@stars-end.ai>
Date:   Sat Dec 20 07:47:46 2025 -0800

    chore(ci): Cleanup legacy logic (P2 complete)
    
    - Remove unused SUPABASE_* env vars from ci.yml (Tier 2/3 now Railway-native)
    - Remove deleted scripts/legacy/setup-clerk-stub.sh and its reference
    - Deduplicate Clerk fixture check steps in ci.yml
    
    Feature-Key: bd-t9as
    Agent: antigravity
    Role: devops-engineer

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index 198d8d7..ebb836c 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -613,20 +613,12 @@ jobs:
       TEST_USER_ROLE: authenticated
       TEST_USER_EMAIL: ${{ secrets.TEST_USER_EMAIL }}
       TEST_USER_PASSWORD: ${{ secrets.TEST_USER_PASSWORD }}
-      # Legacy Supabase vars (fallback)
-      TEST_USER_SUPABASE_ID: 01234567-89ab-cdef-0123-456789abcdef
-      SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
-      SUPABASE_ANON_KEY: ${{ secrets.SUPABASE_ANON_KEY }}
-      SUPABASE_SERVICE_ROLE_KEY: ${{ secrets.SUPABASE_SERVICE_ROLE_KEY }}
     steps:
       - uses: actions/checkout@v4
 
       - name: Validate Clerk stub fixtures
         run: scripts/ci/check_clerk_fixtures.sh
 
-      - name: Validate Supabase env
-        run: scripts/ci/check_supabase_env.sh
-
       - name: Setup Python via mise
         uses: ./.github/actions/setup-python-mise
 
@@ -737,20 +729,12 @@ jobs:
       TEST_USER_ROLE: authenticated
       TEST_USER_EMAIL: ${{ secrets.TEST_USER_EMAIL }}
       TEST_USER_PASSWORD: ${{ secrets.TEST_USER_PASSWORD }}
-      # Legacy Supabase vars (fallback)
-      TEST_USER_SUPABASE_ID: 01234567-89ab-cdef-0123-456789abcdef
-      SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
-      SUPABASE_ANON_KEY: ${{ secrets.SUPABASE_ANON_KEY }}
-      SUPABASE_SERVICE_ROLE_KEY: ${{ secrets.SUPABASE_SERVICE_ROLE_KEY }}
     steps:
       - uses: actions/checkout@v4
 
       - name: Validate Clerk stub fixtures
         run: scripts/ci/check_clerk_fixtures.sh
 
-      - name: Validate Supabase env
-        run: scripts/ci/check_supabase_env.sh
-
       - name: Setup Python via mise
         uses: ./.github/actions/setup-python-mise
 

commit 10f4ac6d8d0619d0468825ecc8d595f67d745b9a
Author: fengning-starsend <fengning@stars-end.ai>
Date:   Sat Dec 20 07:30:34 2025 -0800

    fix(ci): Enable Vite proxy to fix CORS localhost/127.0.0.1 mismatch
    
    Root cause: Frontend at http://127.0.0.1:5173 was calling
    http://localhost:8000 (hardcoded fallback), triggering CORS errors
    because browsers treat localhost â‰  127.0.0.1 as different origins.
    
    Fix: Remove VITE_USE_LOCAL_PROXY=false so Vite proxy handles API calls.
    This matches local dev behavior and avoids cross-origin issues.
    
    Feature-Key: bd-t9as
    Agent: antigravity
    Role: devops-engineer

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index 09452ad..198d8d7 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -607,7 +607,7 @@ jobs:
       CLERK_TEST_ISSUER: http://127.0.0.1:8000
       CLERK_TEST_JWKS_PATH: ${{ github.workspace }}/frontend/e2e-smoke/fixtures/clerk-test-jwks.json
       CLERK_TEST_PRIVATE_KEY_PATH: ${{ github.workspace }}/frontend/e2e-smoke/fixtures/clerk-test-private.pem
-      VITE_USE_LOCAL_PROXY: "false"
+      # NOTE: VITE_USE_LOCAL_PROXY removed - Vite proxy handles API calls (avoids CORS localhost/127.0.0.1 mismatch)
       # Railway DB is primary; Supabase kept for compatibility
       DATABASE_URL: ${{ secrets.DATABASE_URL }}
       TEST_USER_ROLE: authenticated
@@ -731,7 +731,7 @@ jobs:
       CLERK_TEST_ISSUER: http://127.0.0.1:8000
       CLERK_TEST_JWKS_PATH: ${{ github.workspace }}/frontend/e2e-smoke/fixtures/clerk-test-jwks.json
       CLERK_TEST_PRIVATE_KEY_PATH: ${{ github.workspace }}/frontend/e2e-smoke/fixtures/clerk-test-private.pem
-      VITE_USE_LOCAL_PROXY: "false"
+      # NOTE: VITE_USE_LOCAL_PROXY removed - Vite proxy handles API calls (avoids CORS localhost/127.0.0.1 mismatch)
       # Railway DB is primary; Supabase kept for compatibility
       DATABASE_URL: ${{ secrets.DATABASE_URL }}
       TEST_USER_ROLE: authenticated

commit b565e402a65a6e981dd3983381bd498d8e4217f0
Author: fengning-starsend <fengning@stars-end.ai>
Date:   Wed Dec 17 20:18:50 2025 -0800

    fix(ci): add supabase to mise install for Tier 1/3 jobs (bd-jbwr) (#416)
    
    * fix(ci): add supabase to mise install for Tier 1/3 jobs
    
    ci:doctor requires supabase CLI which was missing from Tier 1 (UI Mock
    Smoke) and Tier 3 (Full Stack) mise install steps. Tier 2 already had it.
    
    Feature-Key: bd-jbwr
    Agent: antigravity
    Role: devops-engineer
    
    * chore(beads): close bd-jbwr epic - MVP v1 verification complete
    
    Closed:
    - bd-jbwr.4: Deferred (manual Plaid sandbox)
    - bd-jbwr.5: LOCAL verified (dashboard)
    - bd-jbwr.6: LOCAL verified (EODHD)
    - bd-jbwr: Epic closed (all 7 children resolved)
    
    Feature-Key: bd-jbwr
    Agent: antigravity
    Role: devops-engineer

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index 7f72bc6..09452ad 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -542,8 +542,8 @@ jobs:
           echo "$HOME/.local/bin" >> "$GITHUB_PATH"
           echo "$HOME/.local/share/mise/shims" >> "$GITHUB_PATH"
           ~/.local/bin/mise trust --yes || true
-          # Tier 2 needs node/pnpm/go; Python is provided by runner/setup-python in later steps
-          ~/.local/bin/mise install node pnpm go
+          # Tier 1 needs node/pnpm/go/supabase; Python is provided by runner/setup-python in later steps
+          ~/.local/bin/mise install node pnpm go supabase
           ~/.local/bin/mise doctor --quiet || echo "mise doctor completed with warnings"
 
       - name: Setup Poetry
@@ -760,8 +760,8 @@ jobs:
           echo "$HOME/.local/bin" >> "$GITHUB_PATH"
           echo "$HOME/.local/share/mise/shims" >> "$GITHUB_PATH"
           ~/.local/bin/mise trust --yes || true
-          # Tier 3 needs node/pnpm/go; Python is provided by runner/setup-python in later steps
-          ~/.local/bin/mise install node pnpm go
+          # Tier 3 needs node/pnpm/go/supabase; Python is provided by runner/setup-python in later steps
+          ~/.local/bin/mise install node pnpm go supabase
           ~/.local/bin/mise doctor --quiet || echo "mise doctor completed with warnings"
 
       - name: Setup Poetry

commit 592ef4a2c9699a83f8ed01a672a43bbab690ff53
Author: fengning-starsend <fengning@stars-end.ai>
Date:   Sun Dec 14 19:15:12 2025 -0800

    fix(ci): Fix yq and playwright permissions
    
    Feature-Key: bd-l7f4

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index 197a153..7f72bc6 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -1,4 +1,5 @@
 name: CI
+# Force run: fix-ci-permissions-v2
 
 on:
   push:

commit 7b512ce87c524f09bfd1d517101383d0f3f23b42
Author: fengning-starsend <fengning@stars-end.ai>
Date:   Sun Dec 14 11:09:50 2025 -0800

    fix(ci): Remove sudo requirement from Playwright and fix mise warnings
    
    Feature-Key: bd-l7f4

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index 91b28c3..197a153 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -567,7 +567,7 @@ jobs:
         run: cd frontend && pnpm install --frozen-lockfile
 
       - name: Install Playwright browsers
-        run: cd frontend && pnpm exec playwright install --with-deps
+        run: cd frontend && pnpm exec playwright install chromium
 
       - name: Doctor local prerequisites
         run: pnpm ci:doctor --tier ui --mode hosted
@@ -695,7 +695,7 @@ jobs:
           git diff --exit-code poetry.lock || (echo "backend/poetry.lock drift; run scripts/fix-locks.sh" && exit 1)
 
       - name: Install Playwright browsers
-        run: cd frontend && pnpm exec playwright install --with-deps
+        run: cd frontend && pnpm exec playwright install chromium
 
 
 
@@ -795,7 +795,7 @@ jobs:
           cd ../backend && poetry install --no-interaction --no-root
 
       - name: Install Playwright browsers
-        run: cd frontend && pnpm exec playwright install --with-deps
+        run: cd frontend && pnpm exec playwright install chromium
 
       - name: Doctor hosted Supabase prerequisites
         run: pnpm ci:doctor --mode hosted --tier full

commit 22fa6f728bf1e321af4a373f58b8a154c0488bcd
Author: fengning-starsend <fengning@stars-end.ai>
Date:   Sat Dec 13 15:20:02 2025 -0800

    ci: install PyYAML for guardrails jobs (#366)
    
    * ci: install PyYAML for guardrails on runners
    
    Feature-Key: bd-0ecy
    
    Agent: codex-cli
    
    Role: coordinator
    
    * ci: use mise python for YAML guardrail job
    
    Feature-Key: bd-0ecy
    
    Agent: codex-cli
    
    Role: coordinator
    
    * ci: fix path to check-ci-matrix script
    
    Feature-Key: bd-0ecy
    
    Agent: codex-cli
    
    Role: coordinator

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index 3e21b30..91b28c3 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -58,6 +58,9 @@ jobs:
         with:
           fetch-depth: 0
 
+      - name: Setup Python via mise
+        uses: ./.github/actions/setup-python-mise
+
       - name: Install PyYAML for CI guardrail
         run: |
           python3 -m pip install --quiet pyyaml
@@ -65,7 +68,7 @@ jobs:
 
       - name: Check CI job matrix against docs
         run: |
-            python3 scripts/check-ci-matrix.py
+            python3 scripts/ci/check-ci-matrix.py
 
   env-dedupe-guard:
     name: Env/YAML duplicate guard
@@ -74,9 +77,12 @@ jobs:
     if: always()
     steps:
       - uses: actions/checkout@v4
+      - name: Setup Python via mise
+        uses: ./.github/actions/setup-python-mise
 
       - name: Detect duplicate keys in workflows
         run: |
+          python3 -m pip install --quiet pyyaml
           python3 scripts/ci/check_env_dupes.py .github/workflows/ci.yml
 
       - name: Check workflow YAML for duplicate keys
