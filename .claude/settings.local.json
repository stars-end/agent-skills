{
  "permissions": {
    "allow": [
      "Bash(bd epic create:*)",
      "Bash(bd create:*)",
      "Bash(bd update:*)",
      "Bash(bd show:*)",
      "Bash(bd delete:*)",
      "WebSearch",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:docs.z.ai)",
      "Bash(git checkout:*)",
      "Bash(op read:*)",
      "Bash(op item list:*)",
      "Bash(echo \"$ZAI_API_KEY:0:10...\")",
      "Bash(op whoami:*)",
      "Bash(env)",
      "Bash(cat:*)",
      "Bash(ls:*)",
      "Bash(bash -c 'export OP_SERVICE_ACCOUNT_TOKEN=$\\(cat ~/.config/systemd/user/op_token\\) && op item list 2>&1')",
      "Bash(bash -c 'export OP_SERVICE_ACCOUNT_TOKEN=$\\(cat ~/.config/systemd/user/op_token\\) && op read \"\"op://dev/Zhipu-Config/ZAI_API_KEY\"\" 2>&1')",
      "Bash(bash -c 'export OP_SERVICE_ACCOUNT_TOKEN=$\\(cat ~/.config/systemd/user/op_token\\) && op read \"\"op://dev/gz4ahkc3fldjqtdnack6rjzijy/o7i32t3d5qf25qsfii23x4fnyi\"\" 2>&1')",
      "Bash(bash -c '\nexport OP_SERVICE_ACCOUNT_TOKEN=$\\(cat ~/.config/systemd/user/op_token\\)\nZAI_KEY=$\\(op read \"\"op://dev/gz4ahkc3fldjqtdnack6rjzijy/o7i32t3d5qf25qsfii23x4fnyi\"\" 2>/dev/null\\)\n\nif [[ -z \"\"$ZAI_KEY\"\" ]]; then\n  echo \"\"ERROR: Could not retrieve ZAI_API_KEY\"\"\n  exit 1\nfi\n\necho \"\"Key retrieved: ${ZAI_KEY:0:10}...\"\"\n\ndiff_stat=\"\"docs/REPO_SYNC_STRATEGY.md | 1 +\"\"\nbranch=\"\"feature-auto-checkpoint-poc\"\"\n\nresponse=$\\(curl -s -X POST \"\"https://api.z.ai/api/anthropic/v1/messages\"\" \\\\\n  -H \"\"Content-Type: application/json\"\" \\\\\n  -H \"\"x-api-key: $ZAI_KEY\"\" \\\\\n  -H \"\"anthropic-version: 2023-06-01\"\" \\\\\n  -d \"\"{\n    \\\"\"model\\\"\": \\\"\"claude-3-5-haiku-20241022\\\"\",\n    \\\"\"max_tokens\\\"\": 60,\n    \\\"\"messages\\\"\": [{\n      \\\"\"role\\\"\": \\\"\"user\\\"\",\n      \\\"\"content\\\"\": \\\"\"Generate a one-line git commit message \\(max 72 chars\\) for this auto-checkpoint.\\\\\\\\nBranch: $branch\\\\\\\\nChanges:\\\\\\\\n$diff_stat\\\\\\\\n\\\\\\\\nStart with [AUTO] prefix. Be concise. Example: [AUTO] checkpoint: update auth, add logging\\\"\"\n    }],\n    \\\"\"thinking\\\": {\\\"\"type\\\": \\\"\"disabled\\\"\"}\n  }\"\"\\)\n\necho \"\"Response:\"\"\necho \"\"$response\"\" | head -c 500\n')",
      "Bash(bash -c '\nexport OP_SERVICE_ACCOUNT_TOKEN=$\\(cat ~/.config/systemd/user/op_token\\)\nop read \"\"op://dev/gz4ahkc3fldjqtdnack6rjzijy/o7i32t3d5qf25qsfii23x4fnyi\"\" 2>&1\n')",
      "Bash(bash -c '\nexport OP_SERVICE_ACCOUNT_TOKEN=$\\(cat ~/.config/systemd/user/op_token\\)\nZAI_KEY=$\\(op read \"\"op://dev/gz4ahkc3fldjqtdnack6rjzijy/o7i32t3d5qf25qsfii23x4fnyi\"\" 2>&1\\)\n\nif [[ \"\"$ZAI_KEY\"\" == *\"\"ERROR\"\"* ]]; then\n  echo \"\"Still rate limited: $ZAI_KEY\"\"\n  exit 1\nfi\n\necho \"\"Key retrieved: ${ZAI_KEY:0:10}...\"\"\n\ncurl -s -X POST \"\"https://api.z.ai/api/anthropic/v1/messages\"\" \\\\\n  -H \"\"Content-Type: application/json\"\" \\\\\n  -H \"\"x-api-key: $ZAI_KEY\"\" \\\\\n  -H \"\"anthropic-version: 2023-06-01\"\" \\\\\n  -d \"\"{\n    \\\"\"model\\\"\": \\\"\"claude-3-5-haiku-20241022\\\"\",\n    \\\"\"max_tokens\\\"\": 60,\n    \\\"\"messages\\\"\": [{\n      \\\"\"role\\\"\": \\\"\"user\\\"\",\n      \\\"\"content\\\"\": \\\"\"Generate a one-line git commit message \\(max 72 chars\\) for auto-checkpoint. Branch: feature-test. Changes: 2 files. Start with [AUTO]. Example: [AUTO] checkpoint: update docs\\\"\"\n    }],\n    \\\"\"thinking\\\": {\\\"\"type\\\"\": \\\"\"disabled\\\"\"}\n  }\"\" | jq -r \"\".content[0].text // .error // .\"\"\n')"
    ]
  }
}
